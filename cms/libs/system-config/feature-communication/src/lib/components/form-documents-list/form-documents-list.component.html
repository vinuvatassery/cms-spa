<!-- Header Section -->
<section class="app-l-mainTittle">
      <h1 class="maintitle_withicon text-bold"><span aria-label="Cpt Code" aria-hidden="true"
                  class="material-icons sidebar-menu_icon"> settings </span> Forms & Documents </h1>

</section>

<section>

      <div class="flex-row">

            <!-- Table header show only in list -->
            <div class="flex-col" >
                  <p class="pt-1">Add, edit, or deactivate the forms and documents that are available for other users.
                  </p>
                  </div>
            <div class="flex-col" *ngIf="!isDragDropEnabled">
                  <div class="flex-row">
                        <div class="flex-col flex-col-4 mb-3">
                              <kendo-floatinglabel text="Sort">
                                    <kendo-dropdownlist aria-label="Folder Sort"
                                          [fillMode]="formUiStyle.dropDownFillMode" [data]="folderSortLovList"
                                          textField="lovDesc" valueField="lovCode"  [(ngModel)]="sortOrder"
                                          (valueChange)="onSortChange($event)">
                                    </kendo-dropdownlist>
                              </kendo-floatinglabel>
                        </div>
                        <button kendoButton fillMode="clear" themeColor="primary" aria-label="NEW FOLDER"
                              (click)="onAddNewEditFolderClicked()" (click)="onAddFolderClicked(addFolderTemplate )"  > <span class="material-icons"> add</span> NEW FOLDER
                        </button>
                        <button kendoButton fillMode="clear" themeColor="primary" aria-label="UPLOAD FILE"
                        (click)="uploadFilesClicked(uploadFileTemplate)"> <span class="material-icons"> upload</span>
                              UPLOAD
                              FILE </button>
                  </div>
            </div>
      </div>



</section>
<system-config-common-form-document-list [foldersTree] ="folderFileList$ | async" [treeViewSize]='"large"'></system-config-common-form-document-list>
<div class="bottom-fixed-wrapper text-right flex-gap" *ngIf="isDragDropEnabled"> 
      <button kendoButton [primary]="true" look="outline" aria-label="Cancel"> Cancel </button>
      <button kendoButton [primary]="true" aria-label="Update" class="">Update</button>
</div>
<!-- <kendo-dialog *ngIf="isUploadFileDetailPopup" (close)="onCloseUploadFileDetailClicked()"
      class="app-c-modal app-c-modal-sm app-c-modal-np">
      <kendo-dialog-titlebar> Upload New File </kendo-dialog-titlebar>
      <section class="k-dialog-body">
            <p>
                  Select the file and which folder to upload it to.
            </p>
            <div class="flex-row">
                  <div class="flex-col">
                        <kendo-floatinglabel text="Folder Name">
                              <kendo-dropdownlist [fillMode]="formUiStyle.dropDownFillMode">
                              </kendo-dropdownlist>
                        </kendo-floatinglabel>
                  </div>
                  <div class="flex-col mt-2">

                        <kendo-fileselect>
                              <ng-template kendoUploadFileInfoTemplate let-files let-state="state">
                                    <span>
                                          <span *ngIf="!files[0].documentId">{{ files[0].name }} </span>
                                          <button [attr.aria-label]="files[0].name" *ngIf="files[0]?.documentId"
                                                kendoButton look="flat" class="card-link-button">
                                                <a>{{ files[0].name }} </a>
                                          </button>
                                          <br>
                                          <span>{{ files[0]?.size | fileSize }}</span>
                                    </span>
                              </ng-template>
                        </kendo-fileselect>
                        <kendo-formhint>Max file size 25MB</kendo-formhint>

                  </div>
            </div>
      </section>

      <kendo-dialog-actions>
            <div class="justify-content-between">
                  <div class="justify-content-end">
                        <button kendoButton [primary]="true" look="outline" aria-label="Cancel"
                              (click)="onCloseUploadFileDetailClicked()"> Cancel
                        </button>
                        <button kendoButton [primary]="true" aria-label="Upload"> Upload </button>
                  </div>
            </div>

      </kendo-dialog-actions>
</kendo-dialog> -->

<kendo-dialog *ngIf="isUploadFileVersionDetailPopup" (close)="onCloseUploadFileVersionDetailClicked()"
      class="app-c-modal app-c-modal-sm app-c-modal-np">
      <kendo-dialog-titlebar> Upload New File Version </kendo-dialog-titlebar>
      <section class="k-dialog-body">
            <p>
                  The current version will be replaced and will not be accessible to users. This action cannot be
                  undone. Update the file name if needed and select the new file.
            </p>
            <div class="flex-row">
                  <div class="flex-col">
                        <kendo-floatinglabel text="File Name">
                              <kendo-textbox [fillMode]="formUiStyle.inputFillMode">
                              </kendo-textbox>
                        </kendo-floatinglabel>
                  </div>
                  <div class="flex-col mt-2">

                        <kendo-fileselect>
                              <ng-template kendoUploadFileInfoTemplate let-files let-state="state">
                                    <span>
                                          <span *ngIf="!files[0].documentId">{{ files[0].name }} </span>
                                          <button [attr.aria-label]="files[0].name" *ngIf="files[0]?.documentId"
                                                kendoButton look="flat" class="card-link-button">
                                                <a>{{ files[0].name }} </a>
                                          </button>
                                          <br>
                                          <span>{{ files[0]?.size | fileSize }}</span>
                                    </span>
                              </ng-template>
                        </kendo-fileselect>
                        <kendo-formhint>Max file size 25MB</kendo-formhint>

                  </div>
            </div>
      </section>

      <kendo-dialog-actions>
            <div class="justify-content-between">
                  <div class="justify-content-end">
                        <button kendoButton [primary]="true" look="outline" aria-label="Cancel"
                              (click)="onCloseUploadFileVersionDetailClicked()"> Cancel
                        </button>
                        <button kendoButton [primary]="true" aria-label="Upload"> Upload </button>
                  </div>
            </div>

      </kendo-dialog-actions>
</kendo-dialog>
<kendo-dialog *ngIf="isUploadFolderDetailPopup" (close)="onCloseUploadFolderDetailClicked()"
      class="app-c-modal app-c-modal-sm app-c-modal-np">
      <kendo-dialog-titlebar> Upload New Folder </kendo-dialog-titlebar>
      <section class="k-dialog-body">
            <p>
                  Select the folder to upload.
            </p>
            <div class="flex-row">

                  <div class="flex-col mt-2">

                        <kendo-fileselect>
                              <ng-template kendoUploadFileInfoTemplate let-files let-state="state">
                                    <span>
                                          <span *ngIf="!files[0].documentId">{{ files[0].name }} </span>
                                          <button [attr.aria-label]="files[0].name" *ngIf="files[0]?.documentId"
                                                kendoButton look="flat" class="card-link-button">
                                                <a>{{ files[0].name }} </a>
                                          </button>
                                          <br>
                                          <span>{{ files[0]?.size | fileSize }}</span>
                                    </span>
                              </ng-template>
                        </kendo-fileselect>
                        <kendo-formhint>Max file size 25MB</kendo-formhint>

                  </div>
            </div>
      </section>

      <kendo-dialog-actions>
            <div class="justify-content-between">
                  <div class="justify-content-end">
                        <button kendoButton [primary]="true" look="outline" aria-label="Cancel"
                              (click)="onCloseUploadFolderDetailClicked()"> Cancel
                        </button>
                        <button kendoButton [primary]="true" aria-label="Upload"> Upload </button>
                  </div>
            </div>

      </kendo-dialog-actions>
</kendo-dialog>

<kendo-dialog *ngIf="isFormsDocumentDeletePopupShow" class="app-c-modal app-c-modal-sm app-c-modal-np">
      <kendo-dialog-titlebar (close)="onCloseFormsDocumentDeleteClicked()"> Delete File/Folder?</kendo-dialog-titlebar>

      <section class="k-dialog-body mb-2">
            <p>
                  It will be permanently deleted from the system. This action cannot be undone.
            </p>
      </section>
      <kendo-dialog-actions>
            <div class="justify-content-between">
                  <div class="justify-content-end">
                        <button kendoButton [primary]="true" aria-label="Cancel" look="outline"
                              (click)="onCloseFormsDocumentDeleteClicked()">
                              Cancel
                        </button>
                        <button kendoButton class="k-error-button" aria-label="Delete">
                              Delete
                        </button>
                  </div>
            </div>
      </kendo-dialog-actions>
</kendo-dialog>

<kendo-dialog *ngIf="isFormsDocumentDeactivatePopupShow" class="app-c-modal app-c-modal-sm app-c-modal-np">
      <kendo-dialog-titlebar (close)="onCloseFormsDocumentDeactivateClicked()"> Deactivate File/Folder?
      </kendo-dialog-titlebar>

      <section class="k-dialog-body">
            <p class="text-muted mb-2">
                  Users will no longer be able to access it. You may re-activate it at any time.
            </p>
      </section>

      <kendo-dialog-actions>
            <div class="justify-content-between">
                  <div class="justify-content-end">
                        <button kendoButton [primary]="true" look="outline" aria-label="Cancel"
                              (click)="onCloseFormsDocumentDeactivateClicked()">
                              Cancel
                        </button>
                        <button kendoButton [primary]="true" aria-label="Deactivate">
                              Deactivate
                        </button>
                  </div>
            </div>
      </kendo-dialog-actions>
</kendo-dialog>

<kendo-dialog *ngIf="isFormsDocumentReactivatePopupShow" class="app-c-modal app-c-modal-sm app-c-modal-np">
      <kendo-dialog-titlebar (close)="onCloseFormsDocumentReactivateClicked()"> Re-activate File/Folder?
      </kendo-dialog-titlebar>

      <section class="k-dialog-body">
            <p class="text-muted mb-2">
                  Are you sure you want to reactivate again?
            </p>
      </section>

      <kendo-dialog-actions>
            <div class="justify-content-between">
                  <div class="justify-content-end">
                        <button kendoButton [primary]="true" look="outline" aria-label="Cancel"
                              (click)="onCloseFormsDocumentReactivateClicked()">
                              Cancel
                        </button>
                        <button kendoButton [primary]="true" aria-label="Deactivate">
                              Re-activate
                        </button>
                  </div>
            </div>
      </kendo-dialog-actions>
</kendo-dialog>
<ng-template #addFolderTemplate >
      <kendo-dialog-titlebar (close)="onCloseAddNewEditFolderClicked()"> Add New Folder </kendo-dialog-titlebar>
      <system-config-add-folder (addFolder)="addFolderData($event)"
      (onCloseAddNewEditFolderClicked)="onCloseAddNewEditFolderClicked()"> 
  </system-config-add-folder> 
</ng-template>

<ng-template #uploadFileTemplate >
      <kendo-dialog-titlebar (close)="onCloseUploadFileDetailClicked()"> Upload New File </kendo-dialog-titlebar>
      <system-config-upload-files
        (uploadFilesEvent)="uploadFilesEvent($event)" 
         (onCloseUploadFileDetailClicked)="onCloseUploadFileDetailClicked()"
          [getFolders$]="getFolders$" > 
      </system-config-upload-files>
</ng-template>