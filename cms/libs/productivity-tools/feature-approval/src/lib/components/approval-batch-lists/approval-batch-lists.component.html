<section class="k-dialog-body">
   <p>Click on the left and right navigational arrows to browse batches. Select whether to approve or send them back to the user who submitted them.</p>
<div class="custom_scroll_view mt-2">
   <kendo-scrollview
   [data]="batchDetailModalSourceList"
   [width]="width"
   [height]="height"
   [arrows]="true"
   [pageable]="false"
   [activeIndex]="index"
   (itemChanged)="onScrollViewItemChanged($event)"
 >
   <ng-template let-item="item">
    <div>
      <div class="slidertitle-bar">
        <p><strong>Batch # {{item.batchName}} </strong> <label class="ml-1">${{item.totalAmountDue | kendoNumber: 'n2'}}</label> <label class="ml-1"> {{item.totalPayments}} payment(s)</label></p>
      </div>
      <div class="mt-1">
        <kendo-buttongroup class="fill_width_group_btn">
            <button kendoButton id ="approveBatch{{index}}" [toggleable]="true" [selected]="item.batchStatus == 'APPROVED'"   aria-label="Approve" (selectedChange)="onApproveClicked(item,index)">Approve

            </button>
            <button kendoButton id ="sendBackBatch{{index}}" [toggleable]="true" [selected]="item.batchStatus == 'SEND_BACK'"  aria-label="Send Back" (selectedChange)="onSendbackClicked(item,index)">Send Back

            </button>
        </kendo-buttongroup>
    </div>
    <kendo-floatinglabel text="Send Back Notes">
        <kendo-textarea
        #tareaSendBackNotes
        [fillMode]="formUiStyle.inputFillMode"
        [maxlength]="tAreaSendBackNotesMaxLength"
        [rows]="2"
        resizable ="none"
        [(ngModel)]="item.sendBackNotes"
        (valueChange)="sendBackNotesChange(item)"
        aria-label="Send Back Notes"
        title ="{{item.sendBackNotes}}" [disabled]="item.batchStatus == 'APPROVED'"
        >

      </kendo-textarea>
      <kendo-textarea-suffix class="justify-content-end">
        <span class="counter">{{ item.tAreaCessationCounter }}</span>
      </kendo-textarea-suffix>
    </kendo-floatinglabel>

<div class="app-c-table mt-2 mb-2" (click)="$event.stopPropagation();">
  <kendo-grid [resizable]="true" [loading]="isBatchDetailPaymentsGridLoaderShow" [pageSize]="state.take"
  [pageable]="true" [sortable]="true" [skip]="state.skip" [groupable]="false" [reorderable]="true" [resizable]="true"
  [columnMenu]="{ filter: true }" [sort]="state.sort" (dataStateChange)="dataStateChange($event)" [selectable]="true"
  [data]="gridBatchDetailPaymentsData$ | async" (filterChange)="filterChange($event)" [filter]="state.filter">
  <kendo-grid-column field="paymentNbr" title="Item #" [width]="150">
    <ng-template kendoGridFilterMenuTemplate let-filter let-column="column" let-filterService="filterService" format="0">
      <kendo-grid-numeric-filter-menu  [column]="column" [filter]="filter" [filterService]="filterService" [extra]="false" operator="eq">
          <kendo-filter-startswith-operator></kendo-filter-startswith-operator>
          <kendo-filter-eq-operator></kendo-filter-eq-operator>
          <kendo-filter-endswith-operator></kendo-filter-endswith-operator>
          <kendo-filter-contains-operator></kendo-filter-contains-operator>
      </kendo-grid-numeric-filter-menu>
  </ng-template>
  </kendo-grid-column>
  <kendo-grid-column *ngIf="selectedPaymentType=='MEDICAL_CLAIM'" field="invoiceNbr" title="Invoice ID" [width]="150">
    <ng-template kendoGridFilterMenuTemplate let-filter let-column="column" let-filterService="filterService">
      <kendo-grid-numeric-filter-menu  [column]="column" [filter]="filter" [filterService]="filterService" [extra]="false" operator="eq" format="0">
          <kendo-filter-startswith-operator></kendo-filter-startswith-operator>
          <kendo-filter-eq-operator></kendo-filter-eq-operator>
          <kendo-filter-endswith-operator></kendo-filter-endswith-operator>
          <kendo-filter-contains-operator></kendo-filter-contains-operator>
      </kendo-grid-numeric-filter-menu>
  </ng-template>
  </kendo-grid-column>

  <kendo-grid-column *ngIf="selectedPaymentType=='MEDICAL_CLAIM'" field="vendorName" title="Provider Name" [width]="250">
      <ng-template kendoGridFilterMenuTemplate let-filter let-column="column" let-filterService="filterService">
       <kendo-grid-string-filter-menu  [column]="column" [filter]="filter" [filterService]="filterService" [extra]="false" operator="contains">
            <kendo-filter-startswith-operator></kendo-filter-startswith-operator>
            <kendo-filter-eq-operator></kendo-filter-eq-operator>
            <kendo-filter-endswith-operator></kendo-filter-endswith-operator>
            <kendo-filter-contains-operator></kendo-filter-contains-operator>
        </kendo-grid-string-filter-menu>
    </ng-template>
  </kendo-grid-column>
  <kendo-grid-column *ngIf="selectedPaymentType=='INSURANCE_PREMIUM'" field="vendorName" title="Insurance Vendor" [width]="250">
    <ng-template kendoGridFilterMenuTemplate let-filter let-column="column" let-filterService="filterService">
     <kendo-grid-string-filter-menu  [column]="column" [filter]="filter" [filterService]="filterService" [extra]="false" operator="contains">
          <kendo-filter-startswith-operator></kendo-filter-startswith-operator>
          <kendo-filter-eq-operator></kendo-filter-eq-operator>
          <kendo-filter-endswith-operator></kendo-filter-endswith-operator>
          <kendo-filter-contains-operator></kendo-filter-contains-operator>
      </kendo-grid-string-filter-menu>
  </ng-template>
</kendo-grid-column>
<kendo-grid-column *ngIf="selectedPaymentType=='PHARMACY_CLAIM'" field="vendorName" title="Pharmacy Name" [width]="250">
  <ng-template kendoGridFilterMenuTemplate let-filter let-column="column" let-filterService="filterService">
   <kendo-grid-string-filter-menu  [column]="column" [filter]="filter" [filterService]="filterService" [extra]="false" operator="contains">
        <kendo-filter-startswith-operator></kendo-filter-startswith-operator>
        <kendo-filter-eq-operator></kendo-filter-eq-operator>
        <kendo-filter-endswith-operator></kendo-filter-endswith-operator>
        <kendo-filter-contains-operator></kendo-filter-contains-operator>
    </kendo-grid-string-filter-menu>
</ng-template>
</kendo-grid-column>
  <kendo-grid-column *ngIf="selectedPaymentType=='INSURANCE_PREMIUM'" field="premiumCount" title="Item Count" [width]="150" format="0">
    <ng-template kendoGridFilterMenuTemplate let-filter let-column="column" let-filterService="filterService" format="0">
      <kendo-grid-numeric-filter-menu  [column]="column" [filter]="filter" [filterService]="filterService" [extra]="true" operator="eq" format="0">
           <kendo-filter-eq-operator></kendo-filter-eq-operator>
           <kendo-filter-gt-operator></kendo-filter-gt-operator>
           <kendo-filter-gte-operator></kendo-filter-gte-operator>
           <kendo-filter-lt-operator></kendo-filter-lt-operator>
           <kendo-filter-lte-operator></kendo-filter-lte-operator>
       </kendo-grid-numeric-filter-menu>
   </ng-template>
  </kendo-grid-column>
  <kendo-grid-column *ngIf="selectedPaymentType=='MEDICAL_CLAIM'" field="amountDue" title="Total Due" [width]="130">
    <ng-template kendoGridCellTemplate let-dataItem>
      <span class="tableamountview"> <strong>$</strong> {{dataItem.amountDue | kendoNumber: 'n2'}}</span>
  </ng-template>
  <ng-template kendoGridFilterMenuTemplate let-filter let-column="column" let-filterService="filterService">
    <kendo-grid-numeric-filter-menu  [column]="column" [filter]="filter" [filterService]="filterService" [extra]="true" operator="eq">
      <kendo-filter-eq-operator></kendo-filter-eq-operator>
      <kendo-filter-gt-operator></kendo-filter-gt-operator>
      <kendo-filter-gte-operator></kendo-filter-gte-operator>
      <kendo-filter-lt-operator></kendo-filter-lt-operator>
      <kendo-filter-lte-operator></kendo-filter-lte-operator>
    </kendo-grid-numeric-filter-menu>
  </ng-template>
  </kendo-grid-column>
  <kendo-grid-column *ngIf="selectedPaymentType=='INSURANCE_PREMIUM'" field="amountDue" title="Total Amount" [width]="130">
    <ng-template kendoGridCellTemplate let-dataItem>
      <span class="tableamountview"> <strong>$</strong> {{dataItem.premiumTotalAmount | kendoNumber: 'n2'}}</span>
  </ng-template>
  <ng-template kendoGridFilterMenuTemplate let-filter let-column="column" let-filterService="filterService">
    <kendo-grid-numeric-filter-menu  [column]="column" [filter]="filter" [filterService]="filterService" [extra]="true" operator="eq">
      <kendo-filter-eq-operator></kendo-filter-eq-operator>
      <kendo-filter-gt-operator></kendo-filter-gt-operator>
      <kendo-filter-gte-operator></kendo-filter-gte-operator>
      <kendo-filter-lt-operator></kendo-filter-lt-operator>
      <kendo-filter-lte-operator></kendo-filter-lte-operator>
    </kendo-grid-numeric-filter-menu>
  </ng-template>
  </kendo-grid-column>
  <kendo-grid-column field="paymentMethodCode" title="Payment Method" [width]="170">
    <ng-template kendoGridFilterMenuTemplate let-filter let-column="column" let-filterService="filterService">
      <kendo-dropdownlist [data]="paymentMethods" [value]="paymentMethodFilter"  (valueChange)="dropdownFilterChange('paymentMethodCode',$event, filterService)">
      </kendo-dropdownlist>
   </ng-template>
  </kendo-grid-column>
  <kendo-grid-column *ngIf="selectedPaymentType=='MEDICAL_CLAIM'" field="serviceCount" title="Service Count" [width]="150" format="0">
    <ng-template kendoGridFilterMenuTemplate let-filter let-column="column" let-filterService="filterService" format="0">
      <kendo-grid-numeric-filter-menu  [column]="column" [filter]="filter" [filterService]="filterService" [extra]="true" operator="eq" format="0">
           <kendo-filter-eq-operator></kendo-filter-eq-operator>
           <kendo-filter-gt-operator></kendo-filter-gt-operator>
           <kendo-filter-gte-operator></kendo-filter-gte-operator>
           <kendo-filter-lt-operator></kendo-filter-lt-operator>
           <kendo-filter-lte-operator></kendo-filter-lte-operator>
       </kendo-grid-numeric-filter-menu>
   </ng-template>
  </kendo-grid-column>
  <kendo-grid-column *ngIf="selectedPaymentType!='INSURANCE_PREMIUM'" field="clientFullName" title="Client Name" [width]="250">
    <ng-template kendoGridFilterMenuTemplate let-filter let-column="column" let-filterService="filterService">
      <kendo-grid-string-filter-menu  [column]="column" [filter]="filter" [filterService]="filterService" [extra]="false" operator="contains">
           <kendo-filter-startswith-operator></kendo-filter-startswith-operator>
           <kendo-filter-eq-operator></kendo-filter-eq-operator>
           <kendo-filter-endswith-operator></kendo-filter-endswith-operator>
           <kendo-filter-contains-operator></kendo-filter-contains-operator>
       </kendo-grid-string-filter-menu>
   </ng-template>
  </kendo-grid-column>
  <kendo-grid-column *ngIf="selectedPaymentType=='MEDICAL_CLAIM'" field="nameOnInsuranceCard" title="Name on Primary Insurance Card" [width]="265">
    <ng-template kendoGridFilterMenuTemplate let-filter let-column="column" let-filterService="filterService">
      <kendo-grid-string-filter-menu  [column]="column" [filter]="filter" [filterService]="filterService" [extra]="false" operator="contains">
           <kendo-filter-startswith-operator></kendo-filter-startswith-operator>
           <kendo-filter-eq-operator></kendo-filter-eq-operator>
           <kendo-filter-endswith-operator></kendo-filter-endswith-operator>
           <kendo-filter-contains-operator></kendo-filter-contains-operator>
       </kendo-grid-string-filter-menu>
   </ng-template>
  </kendo-grid-column>
  <kendo-grid-column *ngIf="selectedPaymentType!='INSURANCE_PREMIUM'" field="clientId" title="Client ID" [width]="130">
    <ng-template kendoGridFilterMenuTemplate let-filter let-column="column" let-filterService="filterService">
      <kendo-grid-numeric-filter-menu  [column]="column" [filter]="filter" [filterService]="filterService" [extra]="false" operator="eq" format="0">
           <kendo-filter-eq-operator></kendo-filter-eq-operator>
       </kendo-grid-numeric-filter-menu>
   </ng-template>
  </kendo-grid-column>
  <kendo-grid-column *ngIf="selectedPaymentType=='PHARMACY_CLAIM'" field="drugName" title="Drug Name" [width]="200">
    <ng-template kendoGridFilterMenuTemplate let-filter let-column="column" let-filterService="filterService">
     <kendo-grid-string-filter-menu  [column]="column" [filter]="filter" [filterService]="filterService" [extra]="false" operator="contains">
          <kendo-filter-startswith-operator></kendo-filter-startswith-operator>
          <kendo-filter-eq-operator></kendo-filter-eq-operator>
          <kendo-filter-endswith-operator></kendo-filter-endswith-operator>
          <kendo-filter-contains-operator></kendo-filter-contains-operator>
      </kendo-grid-string-filter-menu>
  </ng-template>
  </kendo-grid-column>
  <kendo-grid-column *ngIf="selectedPaymentType=='PHARMACY_CLAIM'" field="ndcCode" title="NDC Code" [width]="130">
    <ng-template kendoGridFilterMenuTemplate let-filter let-column="column" let-filterService="filterService">
     <kendo-grid-string-filter-menu  [column]="column" [filter]="filter" [filterService]="filterService" [extra]="false" operator="contains">
          <kendo-filter-startswith-operator></kendo-filter-startswith-operator>
          <kendo-filter-eq-operator></kendo-filter-eq-operator>
          <kendo-filter-endswith-operator></kendo-filter-endswith-operator>
          <kendo-filter-contains-operator></kendo-filter-contains-operator>
      </kendo-grid-string-filter-menu>
  </ng-template>
  </kendo-grid-column>
  <kendo-grid-column *ngIf="selectedPaymentType=='PHARMACY_CLAIM'" field="rxQty" title="RX Qty" [width]="150" format="0">
    <ng-template kendoGridFilterMenuTemplate let-filter let-column="column" let-filterService="filterService" format="0">
      <kendo-grid-numeric-filter-menu  [column]="column" [filter]="filter" [filterService]="filterService" [extra]="true" operator="eq" format="0">
           <kendo-filter-eq-operator></kendo-filter-eq-operator>
           <kendo-filter-gt-operator></kendo-filter-gt-operator>
           <kendo-filter-gte-operator></kendo-filter-gte-operator>
           <kendo-filter-lt-operator></kendo-filter-lt-operator>
           <kendo-filter-lte-operator></kendo-filter-lte-operator>
       </kendo-grid-numeric-filter-menu>
   </ng-template>
  </kendo-grid-column>
  <kendo-grid-column *ngIf="selectedPaymentType=='PHARMACY_CLAIM'" field="rxType" title="RX Type" [width]="130">
    <ng-template kendoGridFilterMenuTemplate let-filter let-column="column" let-filterService="filterService">
     <kendo-grid-string-filter-menu  [column]="column" [filter]="filter" [filterService]="filterService" [extra]="false" operator="contains">
          <kendo-filter-startswith-operator></kendo-filter-startswith-operator>
          <kendo-filter-eq-operator></kendo-filter-eq-operator>
          <kendo-filter-endswith-operator></kendo-filter-endswith-operator>
          <kendo-filter-contains-operator></kendo-filter-contains-operator>
      </kendo-grid-string-filter-menu>
  </ng-template>
  </kendo-grid-column>
  <kendo-grid-column *ngIf="selectedPaymentType=='PHARMACY_CLAIM'" field="prescriptionTotalAmount" title="Total Amount Paid" [width]="130">
    <ng-template kendoGridCellTemplate let-dataItem>
      <span class="text-muted">$</span>
      {{dataItem.prescriptionTotalAmount}}
  </ng-template>
  <ng-template kendoGridFilterMenuTemplate let-filter let-column="column" let-filterService="filterService">
    <kendo-grid-numeric-filter-menu  [column]="column" [filter]="filter" [filterService]="filterService" [extra]="true" operator="eq">
      <kendo-filter-eq-operator></kendo-filter-eq-operator>
      <kendo-filter-gt-operator></kendo-filter-gt-operator>
      <kendo-filter-gte-operator></kendo-filter-gte-operator>
      <kendo-filter-lt-operator></kendo-filter-lt-operator>
      <kendo-filter-lte-operator></kendo-filter-lte-operator>
    </kendo-grid-numeric-filter-menu>
  </ng-template>
  </kendo-grid-column>
  <kendo-grid-column *ngIf="selectedPaymentType=='PHARMACY_CLAIM'" field="daySupply" title="Days Supply" [width]="150" format="0">
    <ng-template kendoGridFilterMenuTemplate let-filter let-column="column" let-filterService="filterService" format="0">
      <kendo-grid-numeric-filter-menu  [column]="column" [filter]="filter" [filterService]="filterService" [extra]="true" operator="eq" format="0">
           <kendo-filter-eq-operator></kendo-filter-eq-operator>
           <kendo-filter-gt-operator></kendo-filter-gt-operator>
           <kendo-filter-gte-operator></kendo-filter-gte-operator>
           <kendo-filter-lt-operator></kendo-filter-lt-operator>
           <kendo-filter-lte-operator></kendo-filter-lte-operator>
       </kendo-grid-numeric-filter-menu>
   </ng-template>
  </kendo-grid-column>
  <kendo-grid-column *ngIf="selectedPaymentType=='PHARMACY_CLAIM'" field="prescriptionFillDate" title="Fill Date" [width]="150"> </kendo-grid-column>
  <kendo-grid-column field="paymentStatusCode" title="Payment Status" [width]="170">
    <ng-template kendoGridFilterMenuTemplate let-filter let-column="column" let-filterService="filterService">
        <kendo-dropdownlist [data]="paymentStatusList" [value]="paymentStatusFilter"  (valueChange)="dropdownFilterChange('paymentStatusCode',$event, filterService)">
        </kendo-dropdownlist>
   </ng-template>
  </kendo-grid-column>
  <kendo-grid-column *ngIf="selectedPaymentType=='PHARMACY_CLAIM'" field="prescriptionNbr" title="Prescription #" [width]="170">
    <ng-template kendoGridFilterMenuTemplate let-filter let-column="column" let-filterService="filterService">
     <kendo-grid-string-filter-menu  [column]="column" [filter]="filter" [filterService]="filterService" [extra]="false" operator="contains">
          <kendo-filter-startswith-operator></kendo-filter-startswith-operator>
          <kendo-filter-eq-operator></kendo-filter-eq-operator>
          <kendo-filter-endswith-operator></kendo-filter-endswith-operator>
          <kendo-filter-contains-operator></kendo-filter-contains-operator>
      </kendo-grid-string-filter-menu>
  </ng-template>
  </kendo-grid-column>
  <kendo-grid-column field="pcaCode" title="PCA Code" [width]="130">
    <ng-template kendoGridFilterMenuTemplate let-filter let-column="column" let-filterService="filterService">
      <kendo-grid-string-filter-menu  [column]="column" [filter]="filter" [filterService]="filterService" [extra]="false" operator="contains">
           <kendo-filter-eq-operator></kendo-filter-eq-operator>
       </kendo-grid-string-filter-menu>
   </ng-template>
  </kendo-grid-column>
  <kendo-grid-column field="mailCode" title="Mail Code" [width]="130">
    <ng-template kendoGridFilterMenuTemplate let-filter let-column="column" let-filterService="filterService">
      <kendo-grid-string-filter-menu  [column]="column" [filter]="filter" [filterService]="filterService" [extra]="false" operator="contains">
           <kendo-filter-eq-operator></kendo-filter-eq-operator>
       </kendo-grid-string-filter-menu>
   </ng-template>
  </kendo-grid-column>
  <kendo-grid-column field="creatorId" title="By" [filterable]="false" [sortable]="false" [width]="70">
    <ng-template kendoGridCellTemplate let-dataItem>
      <button kendoButton [primary]="true" class="avatar-sm-btn c-default" kendoPopoverAnchor
        [popover]="onUserProfileDetailsHovered" showOn="hover" [attr.aria-label]="dataItem.creatorId">
        <common-user-photo-icon [userId]="dataItem.creatorId"></common-user-photo-icon>
      </button>
      <kendo-popover #onUserProfileDetailsHovered width="330" position="left">
        <ng-template kendoPopoverBodyTemplate>
          <common-user-profile-card [userId]="dataItem?.creatorId" [reassign]=false></common-user-profile-card>
        </ng-template>
      </kendo-popover>
    </ng-template>
  </kendo-grid-column>
    <ng-template kendoPagerTemplate let-totalPages="totalPages" let-pagerFirstPage="pagerFirstPage"
      let-currentPage="currentPage">
      <div class="grid-custom-paginationtemplates d-flex">
        <div class="d-flex align-items-center">
          <label class="mr-1" for="RowsPerPage">Rows Per Page</label>
          <kendo-dropdownlist [fillMode]="formUiStyle.dropDownFillMode" [data]="pageSizes" [textField]="'text'"
            [valueField]="'value'" [valuePrimitive]="true" aria-label="Rows Per Page" id="RowsPerPage"
            [(value)]="state.take" (selectionChange)="pageSelectionChange($event)"></kendo-dropdownlist>
          <kendo-pager-info> </kendo-pager-info>
          <kendo-grid-messages [pagerItems]="' '" [pagerItems]="'Rows'" [pagerPage]="'Page'"> </kendo-grid-messages>
        </div>
        <div class="d-flex">
          <kendo-pager-input></kendo-pager-input>
          <kendo-pager-prev-buttons></kendo-pager-prev-buttons>
          <kendo-pager-next-buttons></kendo-pager-next-buttons>
        </div>
      </div>
    </ng-template>
    <ng-template kendoGridLoadingTemplate>
      <common-grid-loader-component></common-grid-loader-component>
    </ng-template>
    <!-- grid No data Template -->
    <ng-template kendoGridNoRecordsTemplate>
      <div> <kendo-badge-container> <span class="material-icons"> info </span> </kendo-badge-container>
      </div>
      <p>There is no data to display.</p>
    </ng-template>
  </kendo-grid>
</div>
</div>
</ng-template>
</kendo-scrollview>

</div>
</section>
  <kendo-dialog-actions>
    <div class="justify-content-between align-items-center">
      <div class="justify-content-end align-items-center">
    <span class="mr-1">{{approveBatchCount}} batch(es) to be approved, {{sendbackBatchCount}} batch(es) to be sent back</span>

        <button kendoButton [primary]="true" look="outline" aria-label="Cancel" (click)="closeViewPaymentsBatchClicked()">
          Cancel
        </button>
        <button kendoButton [primary]="true" aria-label="Save" (click)="onBatchModalSaveClicked()">Save</button>
      </div>
    </div>
  </kendo-dialog-actions>
