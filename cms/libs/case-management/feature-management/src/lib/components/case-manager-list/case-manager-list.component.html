<!-- User Card Profile Details Popover -->
<kendo-popover #onUserProfileDetailsHovered width="330">
  <ng-template kendoPopoverBodyTemplate>
   <case-management-hiv-case-manager-card  
   [gridHoverDataItem]="gridHoverDataItem"
   [userImage$]="userImage$"
   (loadprofilePhotoEvent)="loadprofilePhotoEventHandler($event)"
    ></case-management-hiv-case-manager-card> 
  </ng-template>
</kendo-popover>


<div class="flex-row">
  <div class="flex-col">
    <div class="app-c-table">
      <kendo-grid [data]="getCaseManagers$ | async">   
    
        <kendo-grid-column field="caseManagerName" title="Case Manager Name" [width]="150">
          <ng-template kendoGridCellTemplate let-dataItem>
            <button look="flat"   class="card-link-button" (mouseover)="onManagerHover(dataItem)" kendoButton   kendoPopoverAnchor   [popover]="onUserProfileDetailsHovered"
            showOn="hover">{{dataItem.caseManagerName}}</button>
          </ng-template> 
        </kendo-grid-column>     
        <kendo-grid-column    field="pNumber"  title="PNUmber"  [width]="100" *ngIf="managementTab" ></kendo-grid-column>  
        <kendo-grid-column    field="domainCode"  title="Domain"  [width]="100" *ngIf="managementTab" ></kendo-grid-column>  
        <kendo-grid-column    field="assisterGroup"  title="Assister Group"  [width]="100" *ngIf="managementTab" ></kendo-grid-column>  
        <kendo-grid-column *ngIf="managementTab" field="assignmentStartDate" title="Effective Date" [width]="100"
        [sortable]="false">
        <ng-template kendoGridCellTemplate let-dataItem>
          {{dataItem.assignmentStartDate | date: 'MM/dd/yyyy'}} {{dataItem.assignmentEndDate ? '-' : ''}} {{dataItem.assignmentEndDate | date: 'MM/dd/yyyy'}}
        </ng-template>
      </kendo-grid-column>
      <kendo-grid-column    field="city"  title="City"  [width]="100" *ngIf="managementTab" ></kendo-grid-column>  
      <kendo-grid-column    field="county"  title="County"  [width]="100" *ngIf="managementTab" ></kendo-grid-column>  
      <kendo-grid-column field="creatorId" title="By" [width]="50" [sortable]="false" *ngIf="managementTab">
        <ng-template kendoGridCellTemplate let-dataItem>
          <button *ngIf="dataItem?.creatorId" kendoButton [primary]="true" class="avatar-sm-btn c-default"
            kendoPopoverAnchor [popover]="onUserProfileDetailsHovered" showOn="hover" aria-label="profile avatar">
            <common-user-photo-icon [userId]="dataItem?.creatorId"></common-user-photo-icon>
          </button>
          <kendo-popover #onUserProfileDetailsHovered width="330" position="left">
            <ng-template kendoPopoverBodyTemplate>
              <common-user-profile-card [userId]="dataItem?.creatorId" [reassign]=false></common-user-profile-card>
            </ng-template>
          </kendo-popover>
        </ng-template>
      </kendo-grid-column>
      <kendo-grid-column     title="Assigning Case Manager"  [width]="100" *ngIf="managementTab" ></kendo-grid-column>  
        <kendo-grid-column  *ngIf="!managementTab"   field="phone"  title="Phone"  [width]="100" ></kendo-grid-column>  
        <kendo-grid-column          field="clientCaseId"          title="Options"    [width]="25" class="text-center"   [sticky]="true"  >
          <ng-template kendoGridCellTemplate let-manager let-clientCaseId="field">
            <kendo-dropdownbutton
              [data]="actions"
              icon="more-vertical"
              title="More option"
              class="TableActionPopup app-dropdown-action"
              buttonClass="k-icon-button"
              [popupSettings]="{ popupClass: popupClassAction, animate: true }"
              aria-label="more actions"
            >             
              <ng-template class="app-dropdown-action-list" kendoDropDownButtonItemTemplate let-dataItem let-clientCaseId="clientCaseId">
                <button kendoButton  look="flat" [attr.aria-label]="dataItem.text" [class]="dataItem.buttonType" aria-hidden="false" (click)="dataItem.click(manager.clientCaseId,manager.caseManagerId);">
                  <span class="material-icons" [attr.aria-label]="dataItem.text" >{{dataItem.icon}}</span>
                  <label>   {{ dataItem.text }} </label>
              </button>                
              
              </ng-template>
            </kendo-dropdownbutton>
          </ng-template>
        </kendo-grid-column>   
         <!-- grid Loader Template -->  
    <ng-template kendoGridLoadingTemplate>
      <common-grid-loader-component></common-grid-loader-component>
     </ng-template>
     <!-- grid No data Template -->  
     <ng-template kendoGridNoRecordsTemplate>
       <div> <kendo-badge-container>   <span class="material-icons">    info   </span>    </kendo-badge-container>
       </div>
       <p>There is no data to display.</p>
     </ng-template>    
      </kendo-grid>
    </div>
    <div class="flex-row" 
    
    >
      <div class="flex-col mt-1" *ngIf="(showAddNewManagerButton$ | async) || managementTab">
        <button
          kendoButton
          [primary]="true"
          icon="add"
          (click)="onOpenManagerSearchClicked('','',false)"
          aria-label="add case manager provider"
        >
         CASE MANAGER
        </button>
      </div>
    </div>
  </div>
</div>



<!-- Search Provider  Modal -->
<kendo-dialog
  *ngIf="editformVisible$ | async"
  (close)="onCloseCsManagerSearchClicked()"
  class="app-c-modal app-c-modal-md app-c-modal-np"
>
  <kendo-dialog-titlebar
    >{{ isEditSearchCaseManagerProvider ? 'Edit Case Manager' : 'Add Case Manager' }}
  </kendo-dialog-titlebar>
  <case-management-case-manager-search 
    [caseManagerSearchList$]="getManagerUsers$"
    [existingCaseManagerData]="existingCaseManagerData"
    [selectedCustomCaseManagerName]="selectedCustomCaseManagerName"
    [selectedCaseManagerId]="selectedCaseManagerId"   
    [isEditSearchCaseManagerValue]="isEditSearchCaseManagerProvider"
    (deleteCaseManagerEvent)="handleManagerRemove($event)"
    (closeCaseManagerSearchEvent)="onCloseCsManagerSearchClicked()"   
    (searchTextEvent)="searchTextEventHandleer($event)"
    (addExistingCaseManagerEvent)="addExistingCaseManagerEventEventHandler($event)"
  ></case-management-case-manager-search>
</kendo-dialog>



<!-- Delete Modal -->
<kendo-dialog
  *ngIf="showDeleteConfirmation"  
  (close)="onDeleteConfirmCloseClicked()"
  class="app-c-modal app-c-modal-sm app-c-modal-np"
>
 <case-management-case-manager-remove-confirmation
 (deleteConfimEvent)="onDeleteConfirmHandle($event)">
 </case-management-case-manager-remove-confirmation>
</kendo-dialog>



