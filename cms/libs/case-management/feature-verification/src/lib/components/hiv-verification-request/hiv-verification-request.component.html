<section [formGroup]="hivVerificationForm" >
  <div  *ngIf="!isSendRequest">
    <div class="flex-row " [ngClass]="{'sendrequest-fieldwithbtn' : (providerValue$ | async) === 'HEALTHCARE_PROVIDER'} ">
     <div class="flex-col flex-col-6"   *ngIf="isEmailFieldVisible">   
      <kendo-floatinglabel  text="Healthcare Provider’s Email Address">
      <kendo-textbox aria-label="healthcare providers email address"  placeholder="Healthcare Provider’s Email Address"
        [fillMode]="formUiStyle.inputFillMode" formControlName="providerEmailAddress">   
      </kendo-textbox>
      </kendo-floatinglabel>
      <kendo-formerror *ngIf="!hivVerificationForm.controls['providerEmailAddress'].valid && hivVerificationForm.controls['providerEmailAddress'].value !== ''">Enter valid Email Address.</kendo-formerror>
      <kendo-formerror *ngIf="!hivVerificationForm.controls['providerEmailAddress'].valid && hivVerificationForm.controls['providerEmailAddress'].value === ''">Healthcare Provider Email Address is required.</kendo-formerror>
    </div>
      <div *ngIf="providerOption === 'CASE_MANAGER' || providerOption === 'HEALTHCARE_PROVIDER'" class="mt-2 flex-col flex-col-5">
        <button
          kendoButton
          [primary]="true"
          class="overlap_right_btn"
          (click)="onSendRequestClicked()"
          *ngIf="!isSendRequest"
          aria-label="send request"
        >
          Send request
        </button>
      </div>
    </div>
    <div class="flex-row ">
      <div class="flex-col flex-col-8"> 
      <kendo-formhint *ngIf="providerOption === 'CASE_MANAGER'"
        >Their Case Manager will receive a notification to provide HIV
        Verification. Once they submit the form, you will receive a notification
        to approve or deny it.</kendo-formhint>
      <kendo-formhint
        *ngIf="isEmailFieldVisible"
        >Their provider will receive an email to fill and sign an HIV Verification form. 
        Once they submit the form, you will receive a notification to approve or deny it.</kendo-formhint>
    </div>
    </div>
    <div class="flex-row" *ngIf="providerOption === 'UPLOAD_ATTACHMENT'">
      <div class="flex-col flex-col-6">  
      <kendo-upload   #Uploadanattachment   id="Uploadanattachment" aria-label="upload proof" name="upload proof"
      [restrictions]="uploadFileRestrictions.fileRestrictions"   [multiple]="false" [autoUpload]="false"  
     [removeUrl]="uploadRemoveUrl"> 
        <ng-template kendoUploadFileInfoTemplate let-files let-state="state">
          <span >
            <span>{{ files[0].name }} </span> 
            <br>
            <span>{{   files[0].size | fileSize }}</span> 
          </span>
        </ng-template>
      </kendo-upload>
      <kendo-formhint>Max file size 25MB</kendo-formhint>
    </div>
    </div>
  </div>
</section>

<!-- Show this after send a request -->
<section>
  <div *ngIf="isSendRequest || isResendRequest">
    <div class="flex-row mt-3 align-items-center">
      <div class="flex-col">
        <span class="app-c-badge badge-primary">
          <span
            class="material-icons"
            aria-label="information"
            aria-hidden="true"
            #refresh
            >info_outline</span
          >
          <span
            >You will receive a notification once the provider submits the HIV Verification</span
          >
        </span>
      </div>
      <div class="flex-col mt-1">
        Sent {{sentDate | date:'MM-dd-yyyy'}}
        <button
          kendoButton
          class="k-primary-link text-t-normal text-underline"
          kendoPopoverAnchor
          [popover]="onUserProfileDetailsHovered"
          showOn="hover"
          #refresh
          aria-label="user profile"
        >
          Sara John
        </button>
        <button
          kendoButton
          class="k-primary-link text-t-normal ml-2 text-underline"
          (click)="onResendRequestClicked()"
          aria-label="re send request"
        >
          Re-send Request
        </button>
      </div>
    </div>
  </div>
</section>

<!-- User Profile Details Card -->

<kendo-popover #onUserProfileDetailsHovered width="330">
  <ng-template kendoPopoverBodyTemplate>
    <common-user-profile-card></common-user-profile-card>
  </ng-template>
</kendo-popover>
