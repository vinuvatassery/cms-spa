<div class="app-l-inner-rapper pt-0 pb-0" kendoRippleContainer kendoTooltip>
  <div class="assigned-to-right" *ngIf="caseWorkerId">
   <span> Assigned To</span>
    <button
      kendoButton
      [primary]="true"
      class="avatar-sm-btn ml-1 c-default"
      kendoPopoverAnchor
      [popover]="userCard"
      showOn="hover"
      aria-label="assigned to"
    >    
    <common-user-photo-icon  [userId]="caseWorkerId"></common-user-photo-icon>        
    </button>
  </div>
  <kendo-popover #userCard width="330" position="left">
    <ng-template kendoPopoverBodyTemplate>
      <common-user-profile-card 
      [userId]="caseWorkerId"     
      [reassign]=true      
      ></common-user-profile-card>
    </ng-template>
  </kendo-popover>

  <!-- Main Title Section -->
  <section class="app-l-mainTittle" *ngIf="loadedClientHeader?.clientFullName">
    <h2 class="title-md">
      {{loadedClientHeader?.clientFullName}}
      <span class="normal-text text-muted pl-1" 
      *ngIf="(loadedClientHeader?.clientOfficialIdFullName.trim().length > 0) && (loadedClientHeader?.clientOfficialIdFullName.trim() !== loadedClientHeader?.clientFullName)">({{loadedClientHeader?.clientOfficialIdFullName}})</span>
      <span
        class="title-star-icon icon-filled" 
        aria-label="user details"
        aria-hidden="true"
      >
        <span
        kendoPopoverAnchor
        [popover]="userDetails"
        showOn="hover"
          class="material-icons"
          aria-label="user information star"
          aria-hidden="true"
          >star</span
        >
      </span>
      <span class="client-pronouns text-muted" title="{{loadedClientHeader?.pronouns}}">{{loadedClientHeader?.pronouns}}</span>
    </h2>
    <div class="title-client-info-block">
      <span class="title-client-info">ID {{loadedClientHeader?.clientId}}</span>
      <span class="title-client-info">CASE ID {{loadedClientHeader?.clientCaseIdentity}}</span>
      <span class="title-client-info">URN {{loadedClientHeader?.urn}}</span>
      <span
        class="title-client-info c-pointer on-hover-t-primary"
        title="Start New Status Period"
        (click)="onStatusPeriodDetailClicked()"
        >{{loadedClientHeader?.caseStatus}}</span
      >
      <span
        class="title-client-info c-pointer on-hover-t-primary"
        title="Change Group"
        (click)="onGroupDetailClicked(loadedClientHeader?.clientCaseEligibilityId)"
        > {{loadedClientHeader?.group}}</span
      >
      <span
        class="title-client-info c-pointer on-hover-t-primary"
        title="Edit Status Period Dates"
        (click)="onStatusPeriodEditClicked()"
        >{{loadedClientHeader?.eilgibilityStartDate}} - {{loadedClientHeader?.eligibilityEndDate}}</span
      >
      <span class="title-client-info">FPL {{loadedClientHeader?.fpl}}%</span>
    </div>
  </section>

  <!-- User Details Popover -->
    <kendo-popover #userDetails [width]="380" position="bottom">
      <ng-template kendoPopoverBodyTemplate>
        <case-management-client-important-info 
        [clientCaseId]="loadedClientHeader?.clientCaseId"
        [clientProfileImpInfo$] ="clientProfileImpInfo$ | async"
        (loadClientImpInfoEvent)="loadClientImpInfo()">
      </case-management-client-important-info>
      </ng-template>
     </kendo-popover>

  <!-- Banners -->
  <case-management-case360-header-notifications *ngIf="loadedClientHeader?.clientCaseEligibilityCerId && loadedClientHeader?.caseStatus!=='DISENROLLED'"
  (createCerSessionEvent)="createCerSession()"
  ></case-management-case360-header-notifications>
</div>

<!-- Status Period Detail Modal -->
<kendo-dialog
  *ngIf="isStatusPeriodDetailOpened"
  (close)="onStatusPeriodDetailClosed()"
  class="app-c-modal app-c-modal-sm app-c-modal-np"
  kendoTooltip
>
  <case-management-eligibility-period-detail
  [clientId]="clientId"
  [clientCaseEligibilityId]="clientCaseEligibilityId"
  [clientCaseId]="clientCaseId"
  [isEdit]="isEditEligibilityFlag"
  (isModalSavedClicked)="onModalSaveAndClose($event)"></case-management-eligibility-period-detail>
</kendo-dialog>

<!-- Eligibility Group Detail Modal -->
<kendo-dialog
  *ngIf="isGroupDetailOpened$ | async "
  (close)="onGroupDetailClosed()"
  class="app-c-modal app-c-modal-sm app-c-modal-np"
  kendoTooltip
>
  <kendo-dialog-titlebar> Change Group </kendo-dialog-titlebar>
  <case-management-group-detail 
    [currentGroup$]="currentGroup$" 
    [ddlGroups$] ="ddlGroups$"
    (updateGroup)="onGroupChangeUpdateClicked($event)"
    (cancelGroupChange)="onGroupChangeCancelClicked()"
    ></case-management-group-detail>
</kendo-dialog>
