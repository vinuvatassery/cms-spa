<!-- User Card Profile Details Popover -->
<kendo-popover #onUserProfileDetailsHovered width="330">
  <ng-template kendoPopoverBodyTemplate>
    <case-management-health-care-provider-card></case-management-health-care-provider-card>
  </ng-template>
</kendo-popover>


<div class="flex-row" *ngIf="!hasNoProvider">
  <div class="flex-col">
    <div class="app-c-table">
      <kendo-grid [data]="healthCareProvidersData$ | async"
      [pageSize]="state.take" 
      [pageable]="true" 
      [sortable]="true" 
      [skip]="state.skip"
      [groupable]="false"
      [reorderable]="true"
      [resizable]="true" 
      [columnMenu]="{ filter: true }"
      [sort]="state.sort"
      (dataStateChange)="dataStateChange($event)">
      <ng-template kendoGridColumnMenuTemplate let-service="service">
        <span class="k-icon k-i-x" (click)="service.close()"
          style="position: absolute; right: 5px; top: 5px;cursor: pointer;"></span>
        <kendo-grid-columnmenu-sort [service]="service">
        </kendo-grid-columnmenu-sort>
        <kendo-grid-columnmenu-chooser [service]="service"> </kendo-grid-columnmenu-chooser>   
        <kendo-grid-columnmenu-lock [service]="service">
        </kendo-grid-columnmenu-lock>
      </ng-template>
    
        <kendo-grid-column field="clinicName" title="Clinic Name" [width]="150">
        </kendo-grid-column>
        <kendo-grid-column
          field="providerName"
          title="Provider Name"
          [width]="150"
        >       
        <ng-template kendoGridCellTemplate let-dataItem>
        <button look="flat"   class="card-link-button" kendoButton   kendoPopoverAnchor   [popover]="onUserProfileDetailsHovered"
        showOn="hover">{{dataItem.providerName}}</button>
      </ng-template>   
      </kendo-grid-column>
        <kendo-grid-column
          field="primaryPhone"
          title="Provider Phone"
          [width]="150"
          [sortable]="false" 
          [columnMenu]="false"
        ></kendo-grid-column>
        <kendo-grid-column
          field="providerAddress"
          title="Provider Address"
          [width]="200"
          [sortable]="false" 
          [columnMenu]="false"
        ></kendo-grid-column>
        <kendo-grid-column
          field="providerId"
          title="Option"
          [width]="75"
          class="text-center"
          [sticky]="true"
          [sortable]="false" 
          [columnMenu]="false"
        >
          <ng-template kendoGridCellTemplate let-provider let-providerId="field">
            <kendo-dropdownbutton
              [data]="actions"
              icon="more-vertical"
              class="TableActionPopup app-dropdown-action"
              buttonClass="k-icon-button"
              [popupSettings]="{ popupClass: popupClassAction, animate: true }"
              aria-label="more actions"
            >             
              <ng-template class="app-dropdown-action-list" kendoDropDownButtonItemTemplate let-dataItem let-providerId="providerId">
                <button kendoButton  look="flat" [attr.aria-label]="dataItem.text" [class]="dataItem.buttonType" aria-hidden="false" (click)="dataItem.click(provider.providerId);">
                  <span class="material-icons" [attr.aria-label]="dataItem.text" >{{dataItem.icon}}</span>
                  <label>   {{ dataItem.text }} </label>
              </button>                
              
              </ng-template>
            </kendo-dropdownbutton>
          </ng-template>
        </kendo-grid-column>
        <ng-template kendoPagerTemplate let-totalPages="totalPages" let-pagerFirstPage="pagerFirstPage"
        let-currentPage="currentPage">
        <div class="grid-custom-paginationtemplates d-flex"> 
          <div class="d-flex align-items-center">    
            <label class="mr-1">Rows Per Page</label> 
            <kendo-dropdownlist [fillMode]="formUiStyle.dropDownFillMode" [data]="pageSizes" [textField]="'text'" [valueField]="'value'"
              [valuePrimitive]="true" [(value)]="state.take"></kendo-dropdownlist>
            <kendo-pager-info> </kendo-pager-info>
            <kendo-grid-messages [pagerItems]="' '" [pagerPage]="'Page'"> </kendo-grid-messages>
    
          </div>
          <div class="d-flex"> 
            <kendo-pager-input></kendo-pager-input> 
            <kendo-pager-prev-buttons></kendo-pager-prev-buttons> 
            <kendo-pager-next-buttons></kendo-pager-next-buttons>
          </div> 
        </div>
      </ng-template>
      </kendo-grid>
    </div>
    <div class="flex-row">
      <div class="flex-col mt-1">
        <button
          kendoButton
          [primary]="true"
          icon="add"
          (click)="onOpenProviderSearchClicked(false)"
          aria-label="add healthcare provider"
        >
          Provider
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Add Provider  Modal -->
<kendo-dialog
  *ngIf="isOpenedProvider"
  (close)="onCloseProviderClicked()"
  class="app-c-modal app-c-modal-sm app-c-modal-np"
>
  <kendo-dialog-titlebar
    >{{ isEditHealthProvider ? 'Edit Provider' : 'Add Provider' }}
  </kendo-dialog-titlebar>
  <case-management-health-care-provider-detail
    [isEditHealthProviderValue]="isEditHealthProvider"
  ></case-management-health-care-provider-detail>
</kendo-dialog>


<!-- Search Provider  Modal -->
<kendo-dialog
  *ngIf="isOpenedProviderSearch"
  (close)="onCloseProviderSearchClicked()"
  class="app-c-modal app-c-modal-sm app-c-modal-np"
>
  <kendo-dialog-titlebar
    >{{ isEditSearchHealthProvider ? 'Edit Health Care Provider' : 'Add Health Care Provider' }}
  </kendo-dialog-titlebar>
  <case-management-health-care-provider-search
    [isEditSearchHealthProviderValue]="isEditSearchHealthProvider"
    (closeProviderSearchEvent)="onCloseProviderSearchClicked()"
  ></case-management-health-care-provider-search>
</kendo-dialog>



<!-- Delete Modal -->
<kendo-dialog
  *ngIf="isOpenedDeleteConfirm"
  (close)="onDeleteConfirmCloseClicked()"
  class="app-c-modal app-c-modal-sm app-c-modal-np"
>
 <case-management-health-care-provider-remove-confirmation
 [prvId]="prvSelectedId" 
 (deleteConfimEvent)="handleAcceptPrvRemove($event)"
 >
 </case-management-health-care-provider-remove-confirmation>
</kendo-dialog>
