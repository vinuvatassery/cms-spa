<div class="flex-row forms_doc-lists">

      <div class="loader-wrap" *ngIf="!foldersTree">
            <div class="loader-item">
              <span class=" k-icon k-i-loading k-input-loading-icon"></span>
            </div>
      </div>
      <kendo-treeview [nodes]="foldersTree" textField="text" kendoTreeViewHierarchyBinding childrenField="items"
            kendoTreeViewExpandable expandBy="documentTemplateId" [hasChildren]="hasChildren" [children]="children" [expandedKeys]="[1]"
            kendoTreeViewLoadMore [pageSize]="10">
            <ng-template kendoTreeViewNodeTemplate let-dataItem>
                  <div class="attachments-lists-wrap"
                        [ngClass]="dataItem.isFolder===false ? 'file_list' : 'directory_list'">
                        <div class="align-items-center">
                              <span class="material-icons folder_icon" aria-hidden="true"
                                    *ngIf="dataItem.isFolder===true">folder</span>
                              <div class="file-section-inner">
                                    <span class="attachments-buttons-wrap" *ngIf="dataItem.isFolder===false">
                                          <button kendoButton look="flat" title="Download" aria-label="Download"
                                          (click)="onDownloadViewFileClick('download',dataItem.documentTemplateId,dataItem.text)">
                                                <span class="material-icons" aria-label="download"
                                                      aria-hidden="true">file_download</span>
                                          </button>
                                          <button kendoButton look="flat" title="Open in new tab" aria-label="open in new tab" 
                                                (click)="onDownloadViewFileClick('view',dataItem.documentTemplateId,dataItem.description)">
                                                <span class="material-icons" aria-label="open in new tab"
                                                      aria-hidden="true">open_in_new</span>
                                          </button>
                                    </span>
                                    <label *ngIf="dataItem.isFolder===false">{{dataItem.text}}
                                    <label class="file_label"> <span class="data_mb">{{dataItem.fileSize| number: '1.0-0'}} MB</span> 
                                          <span class="fileversion">V1</span>
                                           <!-- <span class="file_status" [ngClass]="dataItem.activeFlag=== 'Y' ? 'active_file' : 'inactive_file' ">{{getFlagValue(dataItem.activeFlag)}}</span> -->
                                          </label></label>
                                    <label class="folder_label" *ngIf="dataItem.isFolder===true">{{dataItem.text}} <span *ngIf="dataItem.isFolder===true" class="filecount">{{dataItem.fileCount}} Files</span> 
                                          <!-- <span class="file_status"  [ngClass]="dataItem.activeFlag=== 'Y' ? 'active_file' : 'inactive_file' ">{{getFlagValue(dataItem.activeFlag)}}</span> -->
                                    </label>
                              </div>
                        </div>
                        <span *ngIf="!isPopUp" class="attachments-date">Last Updated
                              {{dataItem.lastModificationTime | date: 'MM/dd/YYYY'}} by
                              <button kendoButton [primary]="true" class="avatar-sm-btn c-default ml-1"
                                    kendoPopoverAnchor [popover]="onUserProfileDetailsHovered" showOn="hover"
                                    [attr.aria-label]="dataItem.modifiedBy">
                                    <div class="app-c-avatar avatar-sm">
                                          <span class="profile-text-avatar">{{dataItem.lastModifierName}}</span>
                                    </div>
                              </button>
                              <kendo-dropdownbutton [data]="moreActions" title="More option" aria-label="more actions"
                                    class="TableActionPopup app-dropdown-action ml-1" buttonClass="k-icon-button"
                                    [popupSettings]="{ popupClass: popupClassAction, animate: true }">
                                    <span class="material-icons"> more_vert </span>
                                    <ng-template class="app-dropdown-action-list" kendoDropDownButtonItemTemplate
                                          let-datalink>
                                          <div *ngIf="dataItem.activeFlag ==='Y' ; else reactiveButton">
                                                <button  *ngIf="datalink.text !== 'Reactivate'" kendoButton look="flat" 
                                                [attr.aria-label]="datalink.text"
                                                      [class]="datalink.buttonType"
                                                      aria-hidden="false"
                                                      (click)="datalink.click($event, dataItem)"
                                                      >
                                                      <span class="material-icons"
                                                            [attr.aria-label]="datalink.text">{{datalink.icon}}</span>
                                                      <label> {{ datalink.text }} </label>
                                                </button>
                                          </div>
                                          <ng-template #reactiveButton>
                                                <div  *ngIf="datalink.text !== 'Deactivate'">
                                                      <button kendoButton look="flat" 
                                                      [attr.aria-label]="datalink.text"
                                                            [class]="datalink.buttonType"
                                                            aria-hidden="false"
                                                            (click)="datalink.click($event, dataItem)"
                                                            >
                                                            <span class="material-icons"
                                                                  [attr.aria-label]="datalink.text">{{datalink.icon}}</span>
                                                            <label> {{ datalink.text }} </label>
                                                      </button>
                                                </div>
                                              </ng-template>
                                    </ng-template>
                              </kendo-dropdownbutton>
                              <kendo-popover #onUserProfileDetailsHovered width="330" position="left">
                                    <ng-template kendoPopoverBodyTemplate>
                                          <common-user-profile-card [userId]="dataItem.lastModifierId">
                                          </common-user-profile-card>
                                    </ng-template>
                              </kendo-popover>
                        </span>
                  </div>
            </ng-template>
            <ng-template kendoTreeViewDragClueTemplate let-action="action" let-destinationItem="destinationItem"
                  let-text="text">
                  <span class="k-drag-status k-font-icon k-icon"
                        [ngClass]="getDragStatus(action, destinationItem)"></span>
                  <span>{{ text }}</span>
            </ng-template>
      </kendo-treeview>
</div>
<ng-template #renameTemplate >
      <kendo-dialog-titlebar (close)="onCloseAddNewEditFolderClicked()" > {{isFolder ? 'Rename Folder': 'Rename File'}}</kendo-dialog-titlebar>
      <common-edit-template-name [templateDesc] = "templateDesc"  [documentTemplateId] = "documentTemplateId"   [isFolder] = "isFolder"  (updateTemplate)="updateTemplate($event)" 
       (onCloseAddNewEditFolderClicked)="onCloseAddNewEditFolderClicked()"> 
  </common-edit-template-name> 
</ng-template>

<ng-template #deactivateTemplates >
 
      <kendo-dialog-titlebar (close)="onCloseFormsDocumentDeactivateClicked()">{{isFolder ? 'Deactivate Folder': 'Deactivate File'}} </kendo-dialog-titlebar>
      <common-deactivate-template  [isFolder] = "isFolder" (onCloseFormsDocumentDeactivateClicked)="onCloseFormsDocumentDeactivateClicked()"> 
  </common-deactivate-template> 
</ng-template>

<ng-template #activateTemplates>
      <kendo-dialog-titlebar (close)="onCloseFormsDocumentReactivateClicked()">{{isFolder ? 'Reactivate Folder': 'Reactivate File'}} </kendo-dialog-titlebar>
      <common-reactivate-template    [isFolder] = "isFolder" (onCloseFormsDocumentReactivateClicked)="onCloseFormsDocumentReactivateClicked()"> 
  </common-reactivate-template> 
</ng-template>