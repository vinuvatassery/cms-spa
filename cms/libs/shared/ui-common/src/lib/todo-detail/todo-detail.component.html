<section class="k-dialog-body" kendoTooltip  [formGroup]="todoDetailsForm" >
  <p class="text-muted mb-2">
    All fields are required unless otherwise stated.
  </p>
  
  <div class="flex-row" >
    <div class="flex-col">
      <kendo-floatinglabel text="Title">
        <kendo-textbox aria-label="todo title"    
        [fillMode]="formUiStyle.inputFillMode"
        formControlName="title" 
        [maxlength]="100">  
       </kendo-textbox>
       <kendo-formerror *ngIf="!todoDetailsForm.controls['title']?.valid && isValidateForm">
        Title is required
      </kendo-formerror>
      </kendo-floatinglabel>
    </div>
    <div class="flex-col">
      <kendo-floatinglabel text="Due Date">
        <kendo-datepicker  format="MM-dd-yyyy"
         [fillMode]="formUiStyle.dateInputFillMode" 
         formatPlaceholder="formatPattern"
         formControlName="dueDate"
         (valueChange)="onDueChange($event)"
         >
        </kendo-datepicker>
        <kendo-formerror *ngIf="!todoDetailsForm.controls['dueDate']?.valid && isValidateForm">
          Due Date is required
        </kendo-formerror>
      </kendo-floatinglabel>
    </div>
    <div class="flex-col flex-col-6">
      <kendo-floatinglabel text="Repeat">
        <kendo-dropdownlist [fillMode]="formUiStyle.dropDownFillMode"
          formControlName="repeat"
          textField="lovDesc"
                valueField="lovCode"
                [valuePrimitive]="true"
          [data]="frequencyTypeCodeSubject$ | async"
          >
        </kendo-dropdownlist>
        <kendo-formerror *ngIf="!todoDetailsForm.controls['repeat']?.valid 
        && isValidateForm 
        && todoDetailsForm.controls['dueDate'].valid">
          Repeat is required
        </kendo-formerror>
      </kendo-floatinglabel>
    </div>
    <div class="flex-col flex-col-6">
      <kendo-floatinglabel text="End Date (Optional)" >
        <kendo-datepicker
          format="MM-dd-yyyy"
          formatPlaceholder="formatPattern"
          [fillMode]="formUiStyle.dateInputFillMode"
          formControlName="endDate"
          (keyup)="endDateValidation()"
          (valueChange)="endDateValidation()"
        >
        </kendo-datepicker>
        <kendo-formerror *ngIf="todoDetailsForm.controls['endDate'].hasError('incorrect')"> Must be after Due Date.</kendo-formerror>

      </kendo-floatinglabel>
    </div>
    <div class="flex-col">
      <kendo-floatinglabel text="Description(Optional)">
        <kendo-textarea
        [fillMode]="formUiStyle.inputFillMode"
          aria-label="custom todo description"
          #tareaCustomTodo
          resizable="auto"
          [maxlength]="tareaCustomTodoMaxLength"
          [value]="tareaCustomTodoDescription"
          (valueChange)="onTareaCustomTodoValueChange($event)"
          formControlName="alertDesc"
        >
          <kendo-textarea-suffix class="justify-content-end">
            <span class="tareacustomtodocounter">{{
              tareaCustomTodoCounter
            }}</span>
          </kendo-textarea-suffix>
        </kendo-textarea>
      </kendo-floatinglabel>
    </div>
    <div class="flex-col mt-2 field_with_info">
      <kendo-floatinglabel text="Link Item To">
        <kendo-dropdownlist aria-label="Link Reminder To"
         [fillMode]="formUiStyle.dropDownFillMode" 
        formControlName="linkTo"
        (valueChange)="onLinkToChange($event)"
        textField="lovDesc"
        valueField="lovCode"
        [valuePrimitive]="true"
        [data]="entityTypeCodeSubject$ | async "> </kendo-dropdownlist>
        <kendo-formerror *ngIf="!todoDetailsForm.controls['linkTo']?.valid
         && isValidateForm ">
         Link Item To is required
        </kendo-formerror>
    </kendo-floatinglabel>
    <span class="material-icons" aria-hidden="true" title="Select an entity if you want this item to be displayed in its profile.">info</span>
    
      </div>
    <div class="flex-col mt-2"   *ngIf="showVendorSearch">
      <div class="autoSelect-search mat-form-no-b-space ">
        <div class="global-search">
          <span
            class="material-icons global-search-icon"
            aria-label="search"
            aria-hidden="true"
            >search</span
          >
          <span *ngIf="medicalProviderSearchLoaderVisibility$ | async"
          class=" k-icon k-i-loading k-input-loading-icon input-inline-loader">
      </span>
          <kendo-multicolumncombobox 
            textField="providerName"
            valueField="providerId"
            [data]="providerSearchResult$ | async"
            [fillMode]="formUiStyle.dropDownFillMode"
            [placeholder]="placeholderText"
           
            (filterChange)="loadVendorsBySearchText($event)"
            [popupSettings]="{popupClass: 'combotable_search_list', animate: true }"
            [filterable]="true"
            formControlName="vendorId"
          >
            <kendo-combobox-column [width]="250">
              <ng-template
                kendoMultiColumnComboBoxColumnCellTemplate
                let-dataItem
              >
                <span class="pr-1">{{ dataItem.providerName }}</span>
                <span class="text-muted">Tin {{ dataItem.tin | tin }}</span>
              </ng-template>
            </kendo-combobox-column>
          </kendo-multicolumncombobox>
        
          <kendo-formerror
          *ngIf="todoDetailsForm?.hasError('required','vendorId') && isValidateForm && todoDetailsForm.controls['linkTo'].valid">Vendor
          is Required
      </kendo-formerror>
        </div>
      </div>
     </div> 
    <div class="flex-col mt-2" *ngIf="showClientSearch">
      <div class="global-search mat-form-no-b-space">
        <span
          class="material-icons global-search-icon"
          aria-label="search case"
          aria-hidden="true"
          >search</span
        >
      <span *ngIf="clientSearchLoaderVisibility$ |async"
        class=" k-icon k-i-loading k-input-loading-icon input-inline-loader">
    </span>
        <kendo-multicolumncombobox 
       
          [data]="clientSearchResult$ |async"
          textField="clientFullName"
          valueField="clientId"
          [placeholder]="placeholderText"
          [fillMode]="formUiStyle.dropDownFillMode"
          (filterChange)="loadClientBySearchText($event)"
          [popupSettings]="{popupClass: 'combotable_search_list', animate: true }"
          [filterable]="true"
          formControlName="clientId"
          [loading]="showClientSearchInputLoader"

          >
          <kendo-combobox-column>
            <ng-template
              kendoMultiColumnComboBoxColumnCellTemplate
              let-dataItem
            >
              <span class="pr-1">{{ dataItem.clientFullName}}</span>
              <span class="pr-1 text-muted">ID {{ dataItem.clientId }}</span>
              <span class="pr-1 text-muted">DOB {{ dataItem.dob  | date: 'MM/dd/yyyy' }}</span>
              <span class="text-muted">SSN {{ dataItem.ssn }}</span>
            </ng-template>
          </kendo-combobox-column>
          
        </kendo-multicolumncombobox>
        <kendo-formerror *ngIf="!todoDetailsForm.controls['clientId']?.valid && isValidateForm && todoDetailsForm.controls['linkTo'].valid">
          Client is required
        </kendo-formerror>
      </div>
    </div>
  </div>
  
</section>


<kendo-dialog-actions kendoTooltip>
  <div class="justify-content-between">
    <div>
      <button kendoButton aria-label="Delete" *ngIf="isEdit"
       class="k-danger-link"(click)="delete()" >  Delete     </button>
    </div>

    <div class="justify-content-end">
      <button
        kendoButton
        [primary]="true"
        look="outline"
        aria-label="Cancel"
        (click)="closeTodoDetailsClicked(false)"
      >
        Cancel
      </button>
      <button kendoButton [primary]="true" aria-label="Create" 
      (click)="CreateToDoItem()">{{isEdit? 'Update' :'Create'}}</button>
    </div>
  </div>
</kendo-dialog-actions>


